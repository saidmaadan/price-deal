{"version":3,"file":"static/webpack/static/development/pages/_app.js.aa0f55ae86c2652ce2c3.hot-update.js","sources":["webpack:///./components/RemoveFromCart.js"],"sourcesContent":["import React, { Component } from 'react';\nimport { Mutation } from 'react-apollo';\nimport styled from 'styled-components';\nimport PropTypes from 'prop-types';\nimport gql from 'graphql-tag';\nimport { CURRENT_USER_QUERY } from './User';\n\nconst REMOVE_FROM_CART_MUTATION = gql`\n  mutation removeFromCart($id: ID!) {\n    removeFromCart(id: $id) {\n      id\n    }\n  }\n`;\n\nconst BigButton = styled.button`\n    font-size: 3rem;\n    background: none;\n    border: 0;\n    &:hover {\n        color: ${props => props.theme.red};\n        cursor: pointer;\n    }\n`;\n\nclass RemoveFromCart extends Component {\n    static propTypes = {\n        id: PropTypes.string.isRequired,\n      };\n      // This gets called as soon as we get a response back from the server after a mutation has been performed\n      update = (cache, payload) => {\n        // 1. first read the cache\n        const data = cache.readQuery({ query: CURRENT_USER_QUERY });\n        // 2. remove that item from the cart\n        const cartItemId = payload.data.removeFromCart.id;\n        data.me.cart = data.me.cart.filter(cartItem => cartItem.id !== cartItemId);\n        // 3. write it back to the cache\n        cache.writeQuery({ query: CURRENT_USER_QUERY, data });\n      };\n      render() {\n        return (\n          <Mutation\n            mutation={REMOVE_FROM_CART_MUTATION}\n            variables={{ id: this.props.id }}\n            update={this.update}\n            optimisticResponse={{\n              __typename: 'Mutation',\n              removeFromCart: {\n                __typename: 'CartItem',\n                id: this.props.id,\n              },\n            }}\n          >\n            {(removeFromCart, { loading, error }) => (\n              <BigButton\n                disabled={loading}\n                onClick={() => {\n                  removeFromCart().catch(err => alert(err.message));\n                }}\n                title=\"Delete Item\"\n              >\n                &times;\n              </BigButton>\n            )}\n          </Mutation>\n        );\n      }\n    }\n    \n    export default RemoveFromCart;\n    export { REMOVE_FROM_CART_MUTATION };\n    "],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AAQA;AAAA;AAAA;AAAA;AAKA;AAAA;AACA;AAIA;;;;;;;;;;;;;;;;;;AAKA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;;;;;;AAAA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAFA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAYA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAaA;;;;AAzCA;AACA;AADA;AAEA;AADA;AACA;AA0CA;;;;;A","sourceRoot":""}